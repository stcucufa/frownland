<!DOCTYPE html>
<html>
    <head>
        <title>Await</title>
        <meta charset="utf8">
        <link rel="stylesheet" href="test.css">
        <script type="module">

import { test } from "./test.js";
import { Deck } from "../lib/deck.js";
import { notification } from "../lib/events.js";
import { Await, dump } from "../lib/score.js";
import { Tape } from "../lib/tape.js";
import { timeout } from "../lib/util.js";

test("Await(f)", t => {
    const item = Await(() => timeout(100));
    t.equal(item.show(), "Await", "show");
    t.undefined(item.duration, "unresolved duration");
    t.equal(!item.failible, true, "infailible (at instantiation)");
});

test("Instantiation", async t => {
    const tape = Tape();
    const instance = tape.instantiate(Await(() => timeout(10)), 17);
    const deck = Deck({ tape });
    deck.now = 27;
    const e = await notification(deck, "await");
    t.equal(e.instance, instance, "instance did end");
    t.equal(dump(instance), "* Await-0 [17, 27[ <undefined>", "dump matches");
});

        </script>
    </head>
    <body>
        <p><a href="index.html">Back</a></p>
    </body>
</html>
