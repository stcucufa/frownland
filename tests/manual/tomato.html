<!DOCTYPE html>
<html>
    <head>
        <title>Tomato</title>
        <meta charset="utf8">
        <link rel="stylesheet" href="../test.css">
        <script type="module">

import { html, K, range } from "../../lib/util.js";
import { Element, Instant, Par, Score, Seq, Set, dump } from "../../lib/score.js";
import { Tape } from "../../lib/tape.js";
import { Deck } from "../../lib/deck.js";

const FPS = 9;

const tape = Tape();
const deck = Deck({ tape });
const score = Score({ tape });

const image = html("img", { src: "tomato01.png" });
const frames = [...range(1, 18)].map(i => Seq(
    Instant(K(`tomato${i.toString().padStart(2, "0")}.png`)),
    Set(image, "src").dur(1000 / FPS)
));

score.add(Par(
    Element(image).dur(Infinity),
    Seq(...frames).repeat()
));

deck.start();

window.$ = () => { console.log(dump(score.instance)); };

        </script>
    </head>
    <body>
    </body>
</html>
