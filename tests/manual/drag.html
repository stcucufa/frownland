<!DOCTYPE html>
<html>
    <head>
        <title>Drag</title>
        <meta charset="utf8">
        <link rel="stylesheet" href="../test.css">
        <style>

div {
    width: 300px;
    height: 200px;
    position: absolute;
    background-color: pink;
    padding: 16px;
    border-radius: 8px;
    box-sizing: border-box;
    left: 200px;
    top: 100px;
}

        </style>
        <script type="module">

import { Deck } from "../../lib/deck.js";
import { Await, Delay, Event, Effect, first, Instant, Score, Seq } from "../../lib/timing.js";
import { dump } from "../../lib/timing/util.js";
import { Tape } from "../../lib/tape.js";
import { imagePromise, K, range } from "../../lib/util.js";

const tape = Tape();
const deck = Deck({ tape });
const score = Score({ tape });
const box = document.querySelector("div");

score.add(Seq(
    Event(box, "pointerdown"),
    Effect(event => {
        event.preventDefault();
        const rect = box.getBoundingClientRect();
        return [event.clientX - rect.x, event.clientY - rect.y];
    }).label("down"),
    first(
        Seq(
            Event(document, "pointermove"),
            Effect(([event, [x0, y0]]) => {
                box.style.left = `${event.clientX - x0}px`;
                box.style.top = `${event.clientY - y0}px`;
            }).var("down")
        ).repeat(),
        Event(document, "pointerup"),
    ),
).repeat());

deck.start();

        </script>
    </head>
    <body>
        <div>Drag me!</div>
    </body>
</html>
